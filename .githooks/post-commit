#!/bin/bash

# ============================================
# JunggiKim.github.io post-commit Hook
# 커밋 후 부모 repo(solodev_root) 포인터 자동 업데이트
# ============================================

PARENT_REPO=$(git rev-parse --show-superproject-working-tree 2>/dev/null)

if [ -z "$PARENT_REPO" ]; then
    exit 0
fi

# macOS 호환: Python으로 상대 경로 계산
SUBMODULE_REL=$(python3 -c "import os; print(os.path.relpath('$(pwd)', '$PARENT_REPO'))")

echo ""
echo "[post-commit] 부모 repo 포인터 업데이트 중..."
cd "$PARENT_REPO"
git add "$SUBMODULE_REL"
git commit -m "chore: update submodule $SUBMODULE_REL" || true
echo "[post-commit] 완료!"
