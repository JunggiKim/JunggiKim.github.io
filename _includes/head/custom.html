<!-- Pretendard Font (Korean) -->
<link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" />

<!-- JetBrains Mono Font (Code) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jetbrains-mono@1.0.6/css/jetbrains-mono.min.css" />

<!-- ğŸ’ Liquid Glass SVG Filters -->
<script>
  // SVG êµ´ì ˆ í•„í„°ë¥¼ bodyì— ë™ì  ì¶”ê°€
  document.addEventListener('DOMContentLoaded', function() {
    const svgFilters = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
    svgFilters.setAttribute('width', '0');
    svgFilters.setAttribute('height', '0');
    svgFilters.setAttribute('style', 'position:absolute;pointer-events:none;');
    svgFilters.innerHTML = `
      <!-- Liquid Glass êµ´ì ˆ íš¨ê³¼ - ë¯¸ì„¸í•œ ë¬¼ê²° -->
      <filter id="liquid-glass-subtle">
        <feTurbulence type="fractalNoise" baseFrequency="0.015" numOctaves="2" result="noise" seed="1"/>
        <feDisplacementMap in="SourceGraphic" in2="noise" scale="3" xChannelSelector="R" yChannelSelector="G"/>
      </filter>

      <!-- Liquid Glass êµ´ì ˆ íš¨ê³¼ - ì¤‘ê°„ -->
      <filter id="liquid-glass-medium">
        <feTurbulence type="fractalNoise" baseFrequency="0.012" numOctaves="3" result="noise" seed="2"/>
        <feDisplacementMap in="SourceGraphic" in2="noise" scale="5" xChannelSelector="R" yChannelSelector="G"/>
      </filter>

      <!-- Liquid Glass êµ´ì ˆ íš¨ê³¼ - ê°•í•¨ (í˜¸ë²„ìš©) -->
      <filter id="liquid-glass-strong">
        <feTurbulence type="fractalNoise" baseFrequency="0.01" numOctaves="3" result="noise" seed="3"/>
        <feDisplacementMap in="SourceGraphic" in2="noise" scale="8" xChannelSelector="R" yChannelSelector="G"/>
      </filter>
    `;
    document.body.insertBefore(svgFilters, document.body.firstChild);
  });
</script>

<!-- ğŸŒ“ Dark Mode Theme Initialization (ê¹œë¹¡ì„ ë°©ì§€) -->
<script>
  // í˜ì´ì§€ ë¡œë“œ ì „ì— í…Œë§ˆ ì ìš© (ê¹œë¹¡ì„ ë°©ì§€)
  (function() {
    // localStorageì—ì„œ ì €ì¥ëœ í…Œë§ˆ ê°€ì ¸ì˜¤ê¸°
    const savedTheme = localStorage.getItem('theme-preference');

    // ì‹œìŠ¤í…œ ë‹¤í¬ëª¨ë“œ ì„¤ì • ê°ì§€
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

    // ìš°ì„ ìˆœìœ„: ì €ì¥ëœ í…Œë§ˆ > ì‹œìŠ¤í…œ ì„¤ì • > ê¸°ë³¸ê°’(light)
    const theme = savedTheme || (prefersDark ? 'dark' : 'light');

    // HTMLì— í…Œë§ˆ ì†ì„± ì¦‰ì‹œ ì ìš©
    document.documentElement.setAttribute('data-theme', theme);

    // bodyì—ë„ í…Œë§ˆ ì†ì„± ì ìš© (CSS ì„ íƒì ì¼ê´€ì„±)
    document.addEventListener('DOMContentLoaded', function() {
      if (document.body) {
        document.body.setAttribute('data-theme', theme);
      }
    });
  })();
</script>

<!-- ğŸ–±ï¸ ì¹´ë“œ ì „ì²´ í´ë¦­ ì‹œ ë§í¬ ì´ë™ -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // í´ë¦­ ê°€ëŠ¥í•œ ì¹´ë“œë¡œ ë§Œë“¤ê¸°
    function makeCardsClickable() {
      // í™ˆí˜ì´ì§€ ê¸€ ëª©ë¡ + ê´€ë ¨ ê¸€ + ì´ì „/ë‹¤ìŒ ê¸€ ì¹´ë“œ
      const cards = document.querySelectorAll('.archive__item, .grid__item');

      cards.forEach(function(card) {
        // ì¹´ë“œ ë‚´ë¶€ì˜ ì²« ë²ˆì§¸ ë§í¬ ì°¾ê¸°
        const link = card.querySelector('a[href]');
        if (!link) return;

        const url = link.getAttribute('href');

        // ì¹´ë“œ ìŠ¤íƒ€ì¼ - í´ë¦­ ê°€ëŠ¥í•˜ê²Œ í‘œì‹œ
        card.style.cursor = 'pointer';

        // ì¹´ë“œ í´ë¦­ ì´ë²¤íŠ¸
        card.addEventListener('click', function(e) {
          // ì´ë¯¸ ë§í¬ë‚˜ ë²„íŠ¼ì„ í´ë¦­í•œ ê²½ìš°ëŠ” ë¬´ì‹œ
          if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON') {
            return;
          }
          // ë§í¬ ë‚´ë¶€ ìš”ì†Œ í´ë¦­í•œ ê²½ìš°ë„ ë¬´ì‹œ
          if (e.target.closest('a') || e.target.closest('button')) {
            return;
          }

          // ì¹´ë“œ í´ë¦­ ì‹œ í•´ë‹¹ ê¸€ë¡œ ì´ë™
          window.location.href = url;
        });
      });
    }

    makeCardsClickable();
  });
</script>

<!-- ğŸŒ“ Dark Mode Toggle Functionality -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const toggleButton = document.querySelector('.theme-toggle');
    const toggleIcon = document.getElementById('theme-toggle-icon');

    if (!toggleButton || !toggleIcon) return;

    // í˜„ì¬ í…Œë§ˆ ê°€ì ¸ì˜¤ê¸°
    function getCurrentTheme() {
      return document.documentElement.getAttribute('data-theme') || 'light';
    }

    // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
    function updateIcon(theme) {
      if (theme === 'dark') {
        toggleIcon.classList.remove('fa-moon');
        toggleIcon.classList.add('fa-sun');
      } else {
        toggleIcon.classList.remove('fa-sun');
        toggleIcon.classList.add('fa-moon');
      }
    }

    // ì´ˆê¸° ì•„ì´ì½˜ ì„¤ì •
    updateIcon(getCurrentTheme());

    // í† ê¸€ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    toggleButton.addEventListener('click', function() {
      const currentTheme = getCurrentTheme();
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';

      // í…Œë§ˆ ì „í™˜
      document.documentElement.setAttribute('data-theme', newTheme);
      if (document.body) {
        document.body.setAttribute('data-theme', newTheme);
      }

      // localStorageì— ì €ì¥
      localStorage.setItem('theme-preference', newTheme);

      // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
      updateIcon(newTheme);
    });

    // ì‹œìŠ¤í…œ í…Œë§ˆ ë³€ê²½ ê°ì§€
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
      // ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì •í•œ í…Œë§ˆê°€ ì—†ì„ ë•Œë§Œ ì‹œìŠ¤í…œ ì„¤ì • ë”°ë¼ê°€ê¸°
      if (!localStorage.getItem('theme-preference')) {
        const newTheme = e.matches ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', newTheme);
        if (document.body) {
          document.body.setAttribute('data-theme', newTheme);
        }
        updateIcon(newTheme);
      }
    });
  });
</script>
